const prefixURL = "https://malware-detector.s3.ap-southeast-1.amazonaws.com/"
window.addEventListener("load",(event)=>{
    const data = JSON.parse(localStorage.getItem("data_malware_detect"))
    const avg_distance_ransomwares = data.avg_distance_ransomwares
    const avg_distance_nonmalwares = data.avg_distance_nonmalwares
    const nearest_distances = data.nearest_distances
    const nearest_distances_nonmalwares = data.nearest_distances_nonmalwares
    const nearest_image_paths = data.nearest_image_paths
    const nearest_image_paths_nonmalwares = data.nearest_image_paths_nonmalwares
    const prediction_label = data.prediction_label
    
    const t1TBody = document.getElementById("t1-tbody")
    for(let i = 0; i < nearest_distances.length; i++){
        let tr = document.createElement("tr")
        let td_index = document.createElement("td")
        let h2_index = document.createElement("h2")
        h2_index.innerHTML = i+1
        td_index.appendChild(h2_index)
        let td_img = document.createElement("td")
        let img = document.createElement("img")
        let lowercase = nearest_image_paths[i].toLowerCase()
        let URL = lowercase.replace("dataset/",prefixURL)
        img.src = URL
        td_img.appendChild(img)
        let td_link = document.createElement("td")
        let a = document.createElement("a")
        a.href = URL
        a.innerHTML = URL
        td_link.appendChild(a)
        let td_posibility = document.createElement("td")
        let h2 = document.createElement("h2")
        h2.innerHTML = nearest_distances[i]
        td_posibility.appendChild(h2)

        tr.appendChild(td_index)
        tr.appendChild(td_img)
        tr.appendChild(td_link)
        tr.appendChild(td_posibility)
        t1TBody.appendChild(tr)
    }

    const t2TBody = document.getElementById("t2-tbody")
    for(let i = 0; i < nearest_distances_nonmalwares.length; i++){
        let tr = document.createElement("tr")
        let td_index = document.createElement("td")
        let h2_index = document.createElement("h2")
        h2_index.innerHTML = i+1
        td_index.appendChild(h2_index)
        let td_img = document.createElement("td")
        let img = document.createElement("img")
        let lowercase = nearest_image_paths_nonmalwares[i].toLowerCase()
        let URL = lowercase.replace("dataset/",prefixURL)
        img.src = URL
        td_img.appendChild(img)
        let td_link = document.createElement("td")
        let a = document.createElement("a")
        a.href = URL
        a.innerHTML = URL
        td_link.appendChild(a)
        let td_posibility = document.createElement("td")
        let h2 = document.createElement("h2")
        h2.innerHTML = nearest_distances[i]
        td_posibility.appendChild(h2)

        tr.appendChild(td_index)
        tr.appendChild(td_img)
        tr.appendChild(td_link)
        tr.appendChild(td_posibility)
        t2TBody.appendChild(tr)
    }

    const label = document.getElementById("prediction-label")
    label.innerHTML = prediction_label 

})